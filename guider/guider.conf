# Guider Configuration

'''
[ Threshold Description ]

- TARGET
    - cpu:       total, idle, user, kernel, irq, iowait, nrCore, steal, temp, pri
    - core:      total, idle, user, kernel, irq, iowait, steal, temp, online
                 curFreq, minFreq, maxFreq, governor
    - gpu:       total
    - mem:       available, free, anon, file, slab, cache, kernel, freeDiff
                 availableDiff, anonDiff, fileDiff, slabDiff, pgDirty, pgRclmBg
                 pgRclmFg, nrMinFlt, pgMlock, oomKill, cmaFree, cmaDev, rss
    - gpumem     total, size
    - swap:      usage, usagePer, usageDiff, swapin, swapout
    - block:     ioWait, read, write, nrMajFlt, nrTask
    - storage:   usagePer, free, favail, readtime, writetime
    - net:       inbound, outbound, recv, trans
    - load:      1m, 5m, 15m
    - fd:        curFd, fdSize
    - sock:      nrUDPSock, nrTCPSock, nrTCPConn, nrUDSSock
    - file:      exist, none, size, count, data, dataInt, dataFloat
    - task:      nrCtx, new, die, abnormal, abnormalCond, count
    - log:       DLT, kernel, journal, syslog, trace, logcat, file
    - func:      native, syscall, python, D-Bus, signal
    - psi:       cpu, memory, io
    - cgroup:    cpu, throttle, memory, read, write, cpuDelay, memDelay, ioDelay
    - battery:   per, left, plugged

- SCOPE
    - SYSTEM:    system resources
    - *NAME/ID:  NAME/ID for specific tasks, devices, events (support regex)
    - KERNEL:    kernel log
    - DLT:       DLT log
    - JOURNAL:   systemd journal log
    - SYSLOG:    syslog log
    - TRACE:     ftrace log
    - LOGCAT:    android log
    - FILE:      file access log
    - SYSCALL:   syscall
    - NATIVE:    native function for C, C++, Rust, Go
    - PYTHON:    python function
    - DBUS:      D-Bus message
    - SIGNAL:    signal

- ATTRIBUTE
    < common >
    - apply:       activation flag (true/false)
    - after:       uptime condition for event handling
    - before:      uptime condition for event handling
    - caution:     caution (string)
    - command:     command set for handling the started event
    - comp:        check compare operation (big, less, eq)
    - includeOR:   task OR filter for inclusion
    - includeAND:  task AND filter for inclusion
    - exceptOR:    task OR filter for exclusion
    - exceptAND:   task AND filter for exclusion
    - explain:     description (string)
    - goneshot:    global oneshot flag (true/false)
    - interval:    duration condition for event (tick)
    - lcommand:    command set for handling the finished event
    - lock:        global lock flag to handle the event exclusively (true/false)
    - max:         maximum count for event handling (tick)
    - message:     event message (string)
    - multicond:   multiple condition flag for event (true/false)
    - oneshot:     one-time event handling flag (true/false)
    - perm:        permission requirement (root)
    - rafter:      runtime condition for event handling
    - rbefore:     runtime condition for event handling
    - re:          regex filter flag for logs (true/false)
    - refresh:     restart timer for items disabled by oneshot (tick)
    - signal:      signal timer for command task (tick{:SIGNAL})
    - skip:        global skip count flag (tick)
    - taskmon:     monitoring status for tasks (true/false)
    - type:        interval value type (avg/min/max)

    < cpu >
    - total:     total CPU usage for system/process/thread (%)
    - idle:      total CPU idle for system (%)
    - user:      user CPU usage for system (%)
    - kernel:    kernel CPU usage for system (%)
    - irq:       irq CPU usage for system (%)
    - iowait:    iowait time for system (%)
    - steal:     steal time for system (%)
    - temp:      temperature average for system
    - pri:       priority for thread

    < core >
    - total:     total CPU usage (%)
    - idle:      total CPU idle (%)
    - user:      user CPU usage (%)
    - kernel:    kernel CPU usage (%)
    - irq:       irq CPU usage (%)
    - iowait:    iowait time (%)
    - steal:     steal time (%)
    - temp:      temperature
    - online:    online status (true/false)
    - curFreq:   current frequency
    - minFreq:   minimum frequency
    - maxFreq:   maximum frequency
    - governor:  governor

    < gpu >
    - total:     total GPU usage for system (%)

    < mem >
    - available:       available memory for system (MB/%)
    - free:            free memory for system (MB/%)
    - anon:            anonymous memory for system (MB/%)
    - file:            file cache for system (MB/%)
    - slab:            slab cache for system (MB/%)
    - cache:           total cache for system (MB/%)
    - kernel:          kernel memory for system (MB/%)
    - freeDiff:        free memory diff for system (MB/%)
    - availableDiff:   available memory diff for system (MB/%)
    - anonDiff:        anonymous memory diff for system (MB/%)
    - fileDiff:        file cache diff for system (MB/%)
    - slabDiff:        slabcache diff for system (MB/%)
    - pgDirty:         dirty page for system (PAGE)
    - pgRclmBg:        background reclaimed memory for system (PAGE)
    - pgRclmFg:        foreground reclaimed memory for system (PAGE)
    - nrMinFlt:        minor fault for system (PAGE)
    - pgMlock:         page lock for system (PAGE)
    - oomKill:         OOM kill count
    - cmaFree:         cma free memory (MB/%)
    - cmaDev:          cma device memory (MB/%)
    - rss:             Resident Set Size for process (MB/%)

    < gpumem >
    - total:     system RAM usage for GPU (MB/%)
    - size:      per-process RAM usage for GPU (MB/%)

    < swap >
    - usage:     swap usage for system (MB)
    - usagePer:  swap usage for system (%)
    - usageDiff: swap usage diff for system (MB)
    - swapin:    swap-in memory for process (MB)
    - swapout:   swap-out memory for process (MB)

    < block >
    - ioWait:    I/O wait time for system (%)
    - read:      read size for system/process (MB)
    - write:     write size for system/process (MB)
    - nrMajFlt:  major fault count for system
    - nrTask:    blocked process count

    < storage >
    - usagePer:  usage for system (%)
    - free:      free space (MB)
    - favail:    file number can be created
    - readtime:  read time (ms)
    - writetime: write time (ms)

    < net >
    - inbound:   RX size for system
    - outbound:  TX size for system
    - recv:      RX size for devices
    - trans:     TX size for devices

    < load >
    - load1m:    loadavg for 1 Min
    - load5m:    loadavg for 5 Min
    - load15m:   loadavg for 15 Min

    < fd >
    - curFd:     file handle number for system
    - fdSize:    file descriptor number for process

    < sock >
    - nrUDPSock: UDP socket number for system
    - nrTCPSock: TCP socket number for system
    - nrTCPConn: TCP(ESTABLISHED) socket number for system
    - nrUDSSock: UDS number for system

    < file >
    - size:      file size
    - count:     file count in directory
    - exist:     file status (true/false)
    - none:      file status (true/false)
    - data:      file data
    - dataInt:   file data of type int
    - dataFloat: file data of type float

    < task >
    - nrCtx:         context switching number for system/thread
    - new:           the number of created tasks
    - die:           the number of terminated tasks
    - abnormal:      the number of abnormal tasks
    - abnormalCond:  condition status of abnormal tasks (ex, D/t/X/Z)
    - count:         count of tasks

    < log >
    - filter:    log filter
    - path:      target file or directory
    - inmount:   monitor flag for the mount point of path (true/false)
    - allmount:  monitor flag for all mount points (true/false)

    < func >
    - thread:    target filter
    - filter:    function filter
    - group:     process grouping status (true/false)
    - main:      target only main thread (true/false)

    < psi >
    - some-avg10:   delay average for 10 seconds for at least one task (%)
    - some-avg60:   delay average for 60 seconds for at least one task (%)
    - some-avg300:  delay average for 300 seconds for at least one task (%)
    - some-diff:    delay diff for at least one task (%)
    - full-avg10:   delay average for 10 seconds for all tasks simultaneously (%)
    - full-avg60:   delay average for 60 seconds for all tasks simultaneously (%)
    - full-avg300:  delay average for 300 seconds for all tasks simultaneously (%)
    - full-diff:    delay diff for all tasks simultaneously (%)

    < cgroup >
    - cpu:         total CPU usage of groups (%)
    - throttle:    total CPU throttle of groups (%)
    - memory:      total memory usage of groups (MB)
    - read:        total block read of groups (MB)
    - write:       total block write of groups (MB)
    - cpuDelay:    total cpu delay based on PSI(some) of groups (%)
    - memDelay:    total mem delay based on PSI(some) of groups (%)
    - ioDelay:     total io delay based on PSI(some) of groups (%)

    < battery >
    - per:         remaining battery capacity (%)
    - left:        remaining battery time
    - plugged:     power connection status (true/false)

- VARIABLE
    - EVTNAME:    event name
    - EVTTIME:    event time
    - EVTUTCTIME: event time (UTC)
    - EVTUPTIME:  event uptime
    - EVTPID:     task PID
    - SELFPID:    Guider PID
    - NUMRUN:     run number
    - NUMREP:     report number
    - PID:        task PID (for top command)
    - OUTPATH:    last output path
    - OUTDIR:     last output dir

- COMMAND (embedded)
    - BUFFER{:SIZE}:            resize the monitoring buffer
    - CLEAR:                    clear the monitoring buffer
    - DISABLE{:RESOURCE}:       disable monitoring of the specific resource
    - ENABLE{:RESOURCE}:        enable monitoring of the specific resource
    - EXIT:                     terminate the Guider process
    - FILTER{:ITEM}:            set the task filter
    - INTERVAL{:SEC}:           change the monitoring interval
    - KILL:                     kill all child tasks
    - OUTPATH:                  change the output path
    - PAUSE{:SEC}:              pause all monitoring activities with buffer clear
    - RELOAD{:PATH}:            reload the threshold config
    - RESET:                    clear the monitoring stats
    - RESTART:                  restart the Guider process
    - SLEEP{:SEC}:              sleep for seconds
    - SAVE{:TICK@NAME#PATH}:    save the monitoring results to the file from the past to some time thereafter
                                buffer trim is applied if TIME is lesser than 0
                                PATH can be multiple paths separated by + sign as input
    - SAVERAW{:TICK@NAME#PATH}: save the monitoring results composed only of raw data to the file from the past to some time thereafter
    - SAVEMIN{:TICK@NAME#PATH}: save the monitoring results composed only of minimal data to the file from the past to some time thereafter
                                buffer trim is applied if TIME is lesser than 0
                                PATH can be multiple paths separated by + sign as input
    - SAVECPU:                  save total cpu usages
    - SAVEMEM:                  save memory usages
    - SAVEMEMPROC:              save memory usages with smaps info
    - SAVEBLOCK:                save block times
    - SAVEPID:                  save PIDs
    - SAVERUNTIME:              save runtimes
    - SAVEPRIO:                 save priorities
    - SAVESWAP:                 save swap usages
    - STOP:                     stop the threshold monitoring
    - UPDATE:PATH               update the threshold data from the file

- CHARACTER
    - #: ignore a line
    - ''': ignore specific range
'''

<threshold>
{

    "COMMAND": {

        "CMD_NOTIFY_WARN": "GUIDER cli upstream:notify:WARN",
        "CMD_TOP": "GUIDER top -o OUTDIR/guider_top_EVTNAME_EVTTIME.out -R 10 -Y c:15",
        "CMD_FTOP": "GUIDER ftop -o OUTDIR/guider_top_EVTNAME_EVTTIME.out -a -R 1 -Y c:15",
        "CMD_FTOP_PROC": "GUIDER ftop -o OUTDIR/guider_top_EVTNAME_EVTTIME.out -a -g EVTPID -R 1 -Y c:15",
        "CMD_MTOP": "GUIDER mtop -o OUTDIR/guider_top_EVTNAME_EVTTIME.out -R 3 -Y c:15",
        "CMD_FUNCREC": "GUIDER funcrec -s OUTDIR/guider_funcrec_EVTNAME_EVTTIME.dat -R 3",
        "CMD_DISKTOP": "GUIDER disktop -R 3 -a -o OUTDIR/guider_block_EVTNAME_EVTTIME.out -Y c:15",
        "CMD_DISKTOP_TOTAL": "GUIDER disktop -e T -R 3 -a -o OUTDIR/block_EVTNAME_EVTTIME.out -Y c:15",
        "CMD_NETTOP": "GUIDER ntop -R 3 -o OUTDIR/guider_task_EVTNAME_EVTTIME.out -Y c:15",
        "CMD_TTOP_PROC": "GUIDER ttop -g EVTPID -P -R 3 -o OUTDIR/guider_task_EVTNAME_EVTTIME.out -Y c:15",
        "CMD_TTOP_CTX": "GUIDER ttop -S C:1 -R 2 -o OUTDIR/guider_task_EVTNAME_EVTTIME.out -Y c:15",
        "CMD_TTOP_UTOP_ALL": "GUIDER ttop -g EVTPID -P -S c:1 -e E -R 1 -Q -c \"GUIDER utop -g PID -H -o OUTDIR/guider_utop_EVTNAME_EVTTIME_COMM_PID.out -R 5 -q LAZYCACHE\"",
        "CMD_TTOP_UTOP_2": "GUIDER ttop -g EVTPID -P -S c:1 -e E -R 1 -Q -q NRTOPRANK:2 -c \"GUIDER utop -g PID -H -o OUTDIR/guider_utop_EVTNAME_EVTTIME_COMM_PID.out -R 5 -q LAZYCACHE\"",
        "CMD_UTOP": "GUIDER utop -g EVTPID -H -o OUTDIR/guider_utop_EVTNAME_EVTTIME_COMM_PID.out -R 3",
        "CMD_LEAK_1G": "GUIDER leaktrace -g EVTPID -T OUTDIR/libleaktracer.so -o OUTDIR/guider_leak_EVTNAME_EVTTIME.out -c 1g",
        "CMD_LEAK_+200M": "GUIDER leaktrace -g EVTPID -T OUTDIR/libleaktracer.so -o OUTDIR/guider_leak_EVTNAME_EVTTIME.out -c +200m"

    },

    "cpu": {

        "SYSTEM": [
            {
                "apply": "true",
                "total": 95,
                "interval": 5,
                "after": "60s",
                "taskmon": "true",
                "oneshot": "true",
                "refresh": 10,
                "command": ["SAVE:5s"],
                "message": "system CPU usage is high",
                "explain": "monitor system CPU usage with uptime 60s condition"
            },

            {
                "apply": "false",
                "total": 99,
                "comp": "big",
                "interval": 5,
                "type": "min",
                "perm": "root",
                "lock": "true",
                "skip": 5,
                "max": 5,
                "command": ["CMD_TOP", "CMD_FUNCREC"],
                "message": "system CPU usage is critical",
                "explain": "monitor the minimum CPU usage for system"
            },

            {
                "apply": "false",
                "total": 90,
                "interval": 3,
                "perm": "root",
                "signal": "3:SIGINT",
                "command": ["simpleperf record -g -o /data/perf.dat"],
                "message": "system CPU usage is high",
                "explain": "send SIGINT to the command process after 3 seconds"
            },

            {
                "apply": "false",
                "total": 90,
                "kernel": 80,
                "interval": 2,
                "multicond": "true",
                "lcommand": ["SAVE"],
                "message": "system kernel CPU usage is high",
                "explain": "save monitoring results when the event is finished"
            }
        ],

        "*": [
            {
                "apply": "false",
                "total": 95,
                "interval": 3,
                "oneshot": "true",
                "refresh": 30,
                "lock": "true",
                "perm": "root",
                "exceptOR": ["b.out"],
                "command": ["CMD_TTOP_PROC"],
                "explain": "monitor CPU usage for all processes except for b.out"
            },

            {
                "apply": "false",
                "pri": "R90",
                "oneshot": "true",
                "refresh": 30,
                "exceptOR": ["b.out"],
                "command": ["CMD_TTOP_PROC"],
                "explain": "monitor CPU priority for all processes except for b.out"
            }
        ],

        "yes*": [
            {
                "apply": "false",
                "total": 98,
                "interval": 3,
                "perm": "root",
                "lock": "true",
                "oneshot": "true",
                "command": ["CMD_TTOP_UTOP_2"],
                "explain": "monitor CPU usage for specific processes having name starts with yes"
            }
        ]

    },

    "core": {

        "*": {
            "apply": "false",
            "total": 90,
            "interval": 3,
            "taskmon": "true",
            "command": ["SAVE"],
            "message": "system CORE usage is high",
            "explain": "monitor system CORE usage for all devices"
        },

        "0": {
            "apply": "false",
            "total": 90,
            "interval": 3,
            "taskmon": "true",
            "command": ["SAVECPU"],
            "message": "system CORE usage is high",
            "explain": "monitor system CORE usage for all devices"
        }

    },

    "gpu": {

        "*": {
            "apply": "false",
            "total": 95,
            "interval": 10,
            "taskmon": "true",
            "command": ["SAVE:5s"],
            "message": "system GPU usage is high",
            "explain": "monitor system GPU usage for all devices"
        }

    },

    "mem": {

        "SYSTEM": [
            {
                "apply": "true",
                "available": 100,
                "oomKill": 1,
                "goneshot": "true",
                "command": ["SAVEMEM"],
                "message": "system available memory is low",
                "explain": "monitor system available memory"
            },

            {
                "apply": "false",
                "free": 100,
                #"pgRclmBg": 102400,
                #"pgRclmFg": 1024,
                "oneshot": "true",
                "refresh": 10,
                "command": ["SAVERAW"],
                "message": "system free memory is low",
                "explain": "monitor system free memory"
            }
        ],

        "*": {
            "apply": "false",
            "rss": 800,
            "perm": "root",
            "oneshot": "true",
            "lock": "true",
            "exceptOR": ["b.out"],
            "command": ["CMD_LEAK_1G"],
            "explain": "monitor RSS for all processes"
        },

        "a.out*": {
            "apply": "false",
            "rss": 10,
            "interval": 3,
            "perm": "root",
            "oneshot": "true",
            "lock": "true",
            "command": ["CMD_LEAK_+200M"],
            "explain": "monitor RSS for all processes"
        }

    },

    "gpumem": {

        "SYSTEM": {
            "apply": "false",
            "total": 2048,
            "oneshot": "true",
            "command": ["CMD_MTOP"],
            "message": "GPU memory usage is high",
            "explain": "monitor system GPU memory"
        },

        "*": {
            "apply": "false",
            "size": 310,
            "perm": "root",
            "oneshot": "true",
            "exceptOR": ["b.out"],
            "command": ["SAVE:3s"],
            "message": "GPU memory usage for the specific process is high",
            "explain": "monitor GPU-dedicated memory for all processes"
        },

        "weston": {
            "apply": "false",
            "size": 500,
            "perm": "root",
            "oneshot": "true",
            "command": ["SAVE:3s"],
            "message": "GPU memory usage for the specific process is high",
            "explain": "monitor GPU-dedicated memory for specific processes having name weston"
        }

    },

    "swap": {

        "SYSTEM": {
            "apply": "false",
            "usagePer": 95,
            "interval": 5,
            "perm": "root",
            "command": ["CMD_MTOP"],
            "message": "system SWAP usage is high",
            "explain": "monitor system swap usage"
        },

        "*": {
            "apply": "false",
            "swap": 100,
            "exceptOR": ["b.out"],
            "command": ["CMD_MTOP"],
            "explain": "monitor swapped out memory for all processes"
        }

    },

    "block": {

        "SYSTEM": {
            "apply": "false",
            "ioWait": 10,
            "interval": 5,
            "perm": "root",
            "command": ["SAVEBLOCK", "CMD_DISKTOP"],
            "message": "system I/O is heavy",
            "explain": "monitor system block time"
        },

        "*": {
            "apply": "false",
            "read": "500M",
            "write": "100M",
            "perm": "root",
            "interval": 2,
            "exceptOR": ["b.out"],
            "command": ["CMD_DISKTOP_TOTAL"],
            "explain": "monitor block I/O usage for all processes"
        },

        "a.out*": {
            "apply": "false",
            "read": "500M",
            "write": "100M",
            "interval": 2,
            "perm": "root",
            "command": ["CMD_DISKTOP_TOTAL"],
            "explain": "monitor block I/O usage for specific processes having name starts with a.out"
        }

    },

    "storage": {

        "SYSTEM": {
            "apply": "false",
            "usagePer": 95,
            "comp": "big",
            "interval": 3,
            "oneshot": "true",
            "perm": "root",
            "command": ["CMD_DISKTOP"],
            "message": "system storage usage is high",
            "explain": "monitor system storage usage"
        },

        "*": {
            "apply": "false",
            "usagePer": 99,
            "free": 100,
            "interval": 5,
            "exceptOR": ["/dev/loop*"],
            "perm": "root",
            "oneshot": "true",
            "command": ["CMD_DISKTOP"],
            "explain": "monitor storage usage for all devices"
        },

        "/dev/sda2": {
            "apply": "false",
            "usagePer": 99,
            "free": 100,
            "interval": 3,
            "perm": "root",
            "oneshot": "true",
            "command": ["CMD_DISKTOP"],
            "explain": "monitor storage usage for the specific device"
        }

    },

    "net": {

        "SYSTEM": {
            "apply": "false",
            "inbound": "1G",
            "outbound": "500M",
            "interval": 3,
            "perm": "root",
            "command": ["CMD_NETTOP"],
            "message": "system network usage is high",
            "explain": "monitor system network usage"
        },

        "*": {
            "apply": "false",
            "recv": "1G",
            "trans": "500M",
            "interval": 3,
            "exceptOR": ["lo"],
            "perm": "root",
            "command": ["CMD_NETTOP"],
            "explain": "monitor network usage for all devices"
        },

        "enp7s0": {
            "apply": "false",
            "recv": "1G",
            "trans": "1G",
            "perm": "root",
            "interval": 3,
            "command": ["CMD_NETTOP"],
            "explain": "monitor network usage for the specific device"
        }

    },

    "load": {

        "SYSTEM": {
            "apply": "false",
            "load1m": 8,
            "command": ["SAVE"],
            "message": "system loadavg value is high",
            "explain": "monitor system load"
        }

    },

    "fd": {

        "SYSTEM": {
            "apply": "false",
            "curFd": 90000,
            "perm": "root",
            "oneshot": "true",
            "command": ["CMD_FTOP"],
            "explain": "monitor file descriptors of the system"
        },

        "*": {
            "apply": "false",
            "fdSize": 10000,
            "perm": "root",
            "oneshot": "true",
            "refresh": 100,
            "command": ["CMD_FTOP_PROC"],
            "exceptOR": ["*.out", "screen"],
            "explain": "monitor file descriptors of the all processes"
        },

        "a.out": {
            "apply": "false",
            "fdSize": 10000,
            "perm": "root",
            "oneshot": "true",
            "command": ["CMD_FTOP_PROC"],
            "explain": "monitor file descriptors of the specific processes"
        }

    },

    "sock": {

        "SYSTEM": {
            "apply": "false",
            "interval": 5,
            "nrUDPSock": 10000,
            "nrTCPSock": 10000,
            "nrTCPConn": 10000,
            "nrUDSSock": 10000,
            "perm": "root",
            "oneshot": "true",
            "command": ["CMD_FTOP"],
            "explain": "monitor all sockets of the system"
        }

    },

    "file": {

        "/tmp/boot_done": {
            "apply": "false",
            "none": "true",
            "perm": "root",
            "oneshot": "true",
            "after": "1m",
            "command": ["SAVE"],
            "explain": "monitor specific files of the system"
        },

        "/tmp/PEACE*": {
            "apply": "false",
            "size": "1M",
            "comp": "big",
            "perm": "root",
            "oneshot": "true",
            "command": ["SAVE"],
            "explain": "monitor specific files of the system"
        },

        "/tmp/TESTDIR": {
            "apply": "false",
            "count": 4,
            "comp": "big",
            "oneshot": "true",
            "command": ["SAVE"],
            "explain": "monitor the specific directory of the system"
        },

        "/tmp/data": [
            {
                "apply": "false",
                "data": "12345.6",
                "re": "false",
                "perm": "root",
                "oneshot": "true",
                "after": "1m",
                "command": ["SAVE"],
                "explain": "monitor specific files of the system"
            },

            {
                "apply": "false",
                "dataInt": 12345,
                #"dataFloat": 12345.6,
                "comp": "big",
                "perm": "root",
                "oneshot": "true",
                "after": "1m",
                "command": ["SAVE"],
                "explain": "monitor specific files of the system"
            }
        ]

    },

    "task": {

        "SYSTEM": [
            {
                "apply": "false",
                "nrCtx": 50000,
                "command": ["CMD_TTOP_CTX"],
                "explain": "monitor context switching of all tasks"
            },

            {
                "apply": "false",
                "new": 1,
                "die": 1,
                "command": ["SAVE"],
                "explain": "monitor lifecycle of all tasks"
            },

            {
                "apply": "false",
                "abnormal": 1,
                "interval": 5,
                "command": ["SAVE"],
                "explain": "monitor abnormal status of all tasks"
            }
        ],

        "*": {
            "apply": "false",
            "exceptOR": ["b.out", "kworker*"],
            "nrCtx": 5000,
            "interval": 3,
            "command": ["SAVE:3s"],
            "explain": "monitor context switching of all tasks except for specific tasks"
        },

        "yes*": [
            {
                "apply": "false",
                "new": 1,
                "die": 1,
                "interval": 3,
                "command": ["SAVE"],
                "explain": "monitor lifecycle of specific tasks having name starts with yes"
            },

            {
                "apply": "false",
                "abnormal": 1,
                "abnormalCond": "Dt",
                "interval": 3,
                "command": ["SAVE"],
                "explain": "monitor abnormal status Dt of specific tasks having name starts with yes"
            },

            {
                "apply": "false",
                "count": 3,
                "comp": "less",
                "interval": 3,
                "command": ["SAVE"],
                "explain": "monitor count of specific tasks having name starts with yes"
            }
        ]

    },

    "log": {

        "DLT": [
            {
                "apply": "false",
                "filter": "*critical*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor DLT logs"
            }
        ],

        "TRACE": [
            {
                "apply": "false",
                "filter": "*ASDF*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "explain": "monitor FTRACE logs"
            }
        ],

        "KERNEL": [
            {
                "apply": "false",
                "filter": "*critical*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor kernel logs"
            }
        ],

        "LOGCAT": [
            {
                "apply": "false",
                "filter": "*ASDF*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor android logs"
            }
        ],

        "JOURNAL": [
            {
                "apply": "false",
                "filter": "*critical*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor systemd journal logs"
            }
        ],

        "SYSLOG": [
            {
                "apply": "false",
                "filter": "*critical*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "perm": "true",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor syslog logs"
            }
        ],

        "FILE": [
            {
                "apply": "false",
                "path": "/tmp",
                "filter": "*critical*+*oops*",
                "re": "false",
                #"filter": ".*peace.*",
                "oneshot": "true",
                "perm": "true",
                "taskmon": "false",
                "inmount": "false",
                "allmount": "false",
                "command": ["SAVE:3s"],
                "caution": "the info log for this event can recreate the event",
                "explain": "monitor file access logs"
            }
        ]

    },

    "func": {

        "NATIVE": [
            {
                "apply": "false",
                "thread": "a.out",
                "group": "true",
                "filter": "write*+read",
                "perm": "true",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "explain": "monitor native function calls of specific tasks"
            }
        ],

        "SYSCALL": [
            {
                "apply": "false",
                "thread": "a.out",
                "group": "false",
                "filter": "write*+read",
                "oneshot": "true",
                "perm": "true",
                "command": ["SAVE:3s"],
                "explain": "monitor syscalls of specific tasks"
            }
        ],

        "PYTHON": [
            {
                "apply": "false",
                "thread": "iotop",
                "main": "true",
                "filter": "write*+read",
                "perm": "true",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "explain": "monitor python method calls of specific tasks"
            }
        ],

        "DBUS": [
            {
                "apply": "false",
                "thread": "dbus-daemon",
                "filter": "*TestInterface*+*OnEmitSignal*",
                "perm": "true",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "explain": "monitor D-Bus messages"
            }
        ],

        "SIGNAL": [
            {
                "apply": "false",
                "thread": "a.out",
                "filter": "SIGINT+SIGSTOP",
                "perm": "true",
                "oneshot": "true",
                "command": ["SAVE:3s"],
                "explain": "save signals of specific tasks"
            }
        ]

    },

    "psi": {

        "cpu": [
            {
                "apply": "false",
                "some-avg10": 30,
                "some-avg60": 30,
                "some-avg300": 30,
                "some-diff": 30,
                "type": "min",
                "interval": 5,
                "oneshot": "true",
                "refresh": 100,
                "command": ["SAVE:3s"],
                "explain": "monitor PSI cpu stats"
            }
        ],

        "memory": [
            {
                "apply": "false",
                "some-avg10": 30,
                "full-avg60": 30,
                "full-avg300": 30,
                "some-diff": 30,
                "type": "min",
                "interval": 5,
                "oneshot": "true",
                "refresh": 100,
                "command": ["SAVE:3s"],
                "explain": "monitor PSI memory stats"
            }
        ],

        "io": [
            {
                "apply": "false",
                "some-avg10": 30,
                "full-avg60": 30,
                "full-avg300": 30,
                "some-diff": 30,
                "type": "min",
                "interval": 5,
                "oneshot": "true",
                "refresh": 100,
                "command": ["SAVE:3s"],
                "explain": "monitor PSI I/O stats"
            }
        ]

    },

    "cgroup": {

        "/": [
            {
                "apply": "false",
                "interval": 3,
                "taskmon": "true",
                "cpu": 400,
                "throttle": 100,
                "command": ["SAVE"],
                "explain": "monitor cgroup CPU usage"
            },

            {
                "apply": "false",
                "interval": 3,
                "taskmon": "true",
                "memory": 300,
                "read": 600,
                "write": 500,
                "command": ["SAVE"],
                "explain": "monitor cgroup memory usage"
            },

            {
                "apply": "false",
                "interval": 2,
                "taskmon": "true",
                "cpuDelay": 90,
                "memDelay": 90,
                "ioDelay": 90,
                "command": ["SAVE"],
                "explain": "monitor cgroup delay"
            }
        ]

    },

    "battery": {

        "SYSTEM": {
            "apply": "false",
            "per": 20,
            "plugged": "false",
            "left": "30m",
            "perm": "root",
            "oneshot": "true",
            "command": ["SAVE"],
            "explain": "monitor specific files of the system"
        }

    }

}



'''
[ Server Description ]

- COMMAND: shortcut for commands

- INIT: commands executed remotely when connected
    - apply:    switch flag
    - perm:     requirement for permission
    - interval: interval for repeatation (TBD)
    - duration: condition for duration
    - command:  command set
    - oneshot:  oneshot flag (TBD)
    - explain:  description

- EVENT: event handlers
    - name:    event name
    - apply:   switch flag
    - command: commands executed when the event occur
    - handler: functions called when the event occur

- CHARACTER
    - #: ignore a line
    - ''': ignore specific range
'''

<server>
{
    "COMMAND": {

        "CMD_RTOP": "GUIDER rtop -Q -i 3 -C",
        "CMD_DOWN": "download:/tmp/*@./backup/",
        "CMD_MAIL": "mail -s \"Warning Report\" master@github.com"

    },

    "INIT": [

        {
            "apply": "false",
            "perm": "none",
            "oneshot": "true",
            "duration": "10s",
            "command": ["CMD_RTOP"],
            "explain": "print system stat in JSON format from the new node to stdout"
        },

        {
            "apply": "false",
            "perm": "none",
            "oneshot": "true",
            "command": ["CMD_RTOP->cat"],
            "explain": "deliver system stat in JSON format from the new node to the cat process in local machine through pipe"
        },

        {
            "apply": "false",
            "perm": "true",
            "oneshot": "false",
            "interval": "10s",
            "command": ["CMD_DOWN"],
            "explain": "download specific files from the new node every 10 seconds"
        }

    ],

    "EVENT": [

        {
            "name": "TEST",
            "apply": "false",
            "command": ["ls -lha", "CMD_MAIL"],
            "handler": ["./test.py:test"],
            "explain": "make a snapshot image for system"
        }

    ]
}



'''
[ Auto Command Description ]

- CHARACTER
    - #: ignore a line
    - ''': ignore specific range
'''

<command>
{
    "apply": "false",
    "list": [
        "GUIDER list",
        "ls -lha"
    ]
}
